---
title: Careful Counting Patterns
---

```{r setup, include=FALSE, echo=FALSE}
library(dspatterns)
library(tidyverse)
library(bakeoff)
library(gt)
```

# Careful Counting Patterns

```{css, echo=FALSE}
# TODO: place in external CSS file
pre code {
    overflow-wrap: unset;
    word-break: unset;
    white-space: unset;
}

pre.numberSource code > span > a:first-child::before {
  left: -0.5em;
}

pre.numberSource {
  margin-left: 2em;
}
```

## Introduction

Private Notes: 

- Use the bakeoff package (diamonds has been seen before)
  - user the bakers datasets
  - how many bakers...
  
## This chapter's pattern

Make treemap visual with R (squares in quadrant)

- Explore: glimpse / head / tail / skimr
- Understand: 
  - tables + viz (distinct / count / geom_col janitor::tabyl)
  - from exploratory plots (confirms or disproves your assumptions about the data) gain an intuition and develop that ability
- Explain: nrow/ncol + combine with glue for inline code? / epoxy
- Share (Collaborate/Communicate): use pointblank; gt for tables?
  
## Explore

This is really good for interactive use. Gives you the rows and columns plus some of row content.

```{r how-many-bakers-glimpse, attr.source='.numberLines'}
glimpse(bakers)
```

When knitting, this will look like console output:

```{r}
bakers
```

This is a bit better for sharing a preview of the dataset. Use gt's `gt_preview()` function when you want to share in a static document.

```{r bakers-gt-preview}
gt_preview(bakers)
```

```{r}
skimr::skim(bakers)
```


## Understand

Janitor functions: `janitor::tabyl()` + a few `adorn_*()` functions (just enough to get understanding)

But are the contestants unique across all the rows? (Did somebody drop out and come back?)

```{r}
bakers %>% distinct(baker_full)
```

- most common first name `baker_first`?

```{r}
bakers %>% distinct(baker_first)
```

`107` is less than the `120` row count we've seen earlier. Let's instead `count()` by first name (`baker_first`)

```{r}
bakers %>% count(baker_first)
```

This is more apparent when sorting with the `sort` option in `count()`.

```{r}
bakers %>% count(baker_first, sort = TRUE)
```

Now we see that the most common first name is `Kate`.

This is useful but a bit confusing because of the sorting (only descending by `name_total`).

```{r}
bakers %>% 
  distinct(series, baker_first) %>%
  add_count(baker_first, sort = TRUE, name = "name_total")
```

   - overall?

Let's do a count of baker by series (were there any series where two people shared the same name?)

```{r}
bakers %>% count(series, baker_first, sort = TRUE)
```

Seems like no? All `n` values are `1` and the total count here is the same as before (`120`). 

```{r}
bakers %>% count(series)
```

This follows the original order of the table (series increasing). Interestingly, the first series started with only 10 but it became at least bakers dozen's worth later on. 

```{r}
bakers_by_series <- bakers %>% count(series)
```

In R Markdown, we often want to use the things we calculated inside the text. We can do that with `r knitr::inline_expr("min(bakers_by_series$n)")`
 
    - per series?
    - per hometown?
    
EXERCISE: Can you figure out if any bakers are from the same hometown? How about from the same hometown and the same series?

```{r}
bakers %>% count(hometown, series, sort = TRUE)
```
    
    - per episode / per series?
    
```{r}
episodes %>% count(series, episode)
```

## Explain

Sometimes, in the text of a document, you might want to describe your data. We can, for example, use `nrow()` to get the number of rows in the table like this `r knitr::inline_expr(" nrow(bakers)")`.

This is similar: bakers %>% n_distinct()



- use inline code
- present with gt() - provide a few basics here

## Share

pointblank::scan_data()
pointblank::draft_validation_report()


- This chapter really ought to be an intro vis / data inspection/exploration section with multiple packages
- introduce functions:
  - dplyr::glimpse()
  - dplyr::distinct() (getting unique rows by selection of columns)
  - dplyr::count() (counting distinct values by rows; count by series, use built-in sort feature)
  - geom_boxplot()
- use some code from course material that uses bakeoff
  - links: https://alison.netlify.app/rls-plot-twist/#19, https://alison.netlify.app/rls-plot-twist/#19 (counting slides)
- start off with histogram and create this plot: https://alison.netlify.app/rls-plot-twist/#19
- histogram of ages of bakers + other interesting plots
- goals: making exploratory bar charts and histograms (useful for initial understanding of the data)



## Project Ideas

(should have a fully working set of Rmd templates, presented in the form of a project template - this can be prepped for the reader with a function call)

The moma dataset (https://apreshill.github.io/data-vis-labs-2018/02-moma.html) would be great for a project
- explore using the lisa palette from paletteer


### Packages Needed

 - installation details (script with `library()` calls)
 - possibly use: https://github.com/rstudio4edu/rmd4edu/blob/master/R/lesson.R


